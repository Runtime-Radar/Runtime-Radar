# Chart

## Parameters

### Global parameters

| Name                                   | Description                                                                                 | Value |
| -------------------------------------- | ------------------------------------------------------------------------------------------- | ----- |
| `global.imageRegistry`                 | Global Docker image registry                                                                | `""`  |
| `global.imagePullSecrets`              | Global Docker registry secret names as an array                                             | `[]`  |
| `global.storageClass`                  | Global StorageClass for Persistent Volume(s)                                                | `""`  |
| `global.clickhouse.tls.enabled`        | Enable TLS traffic support (overrides `tls.enabled`)                                        | `nil` |
| `global.clickhouse.tls.autoGenerated`  | Generate automatically self-signed TLS certificates (overrides `tls.autoGenerated`)         | `nil` |
| `global.clickhouse.tls.existingSecret` | Name of an existing secret that contains the certificates (overrides `tls.existingSecret`)  | `""`  |
| `global.clickhouse.tls.cert`           | Certificate value. Requires `tls.autoGenerated` to be `false` (overrides `tls.cert`)        | `""`  |
| `global.clickhouse.tls.certKey`        | Certificate key value. Requires `tls.autoGenerated` to be `false` (overrides `tls.certKey`) | `""`  |
| `global.clickhouse.tls.certCA`         | CA Certificate value. Requires `tls.autoGenerated` to be `false` (overrides `tls.certCA`)   | `""`  |

### Common parameters

| Name                | Description                                                                            | Value           |
| ------------------- | -------------------------------------------------------------------------------------- | --------------- |
| `nameOverride`      | String to partially override common.fullname template (will maintain the release name) | `""`            |
| `fullnameOverride`  | String to fully override common.fullname template                                      | `""`            |
| `namespaceOverride` | String to fully override common.namespace                                              | `""`            |
| `clusterDomain`     | Kubernetes Cluster Domain                                                              | `cluster.local` |
| `labels`            | Add labels to all the deployed resources                                               | `{}`            |
| `annotations`       | Add annotations to all the deployed resources                                          | `{}`            |
| `imagePullSecrets`  | Global Docker registry secret names as an array                                        | `[]`            |

### ClickHouse parameters

| Name                             | Description                                                                                                | Value                        |
| -------------------------------- | ---------------------------------------------------------------------------------------------------------- | ---------------------------- |
| `image.registry`                 | ClickHouse image registry                                                                                  | `REGISTRY_NAME`              |
| `image.repository`               | ClickHouse image repository                                                                                | `REPOSITORY_NAME/clickhouse` |
| `image.digest`                   | ClickHouse image digest in the way sha256:aa.... Please note this parameter, if set, will override the tag | `""`                         |
| `image.pullPolicy`               | ClickHouse image pull policy                                                                               | `IfNotPresent`               |
| `auth.username`                  | ClickHouse Admin username                                                                                  | `default`                    |
| `auth.password`                  | ClickHouse Admin password                                                                                  | `""`                         |
| `auth.database`                  | Name for a custom database to create                                                                       | `""`                         |
| `auth.existingSecret`            | Name of a secret containing the Admin password                                                             | `""`                         |
| `auth.existingSecretPasswordKey` | Name of the key inside the existing secret                                                                 | `""`                         |
| `tls.enabled`                    | Enable TLS traffic support                                                                                 | `false`                      |
| `tls.autoGenerated`              | Generate automatically self-signed TLS certificates                                                        | `false`                      |
| `tls.existingSecret`             | Name of an existing secret that contains the certificates                                                  | `""`                         |
| `tls.certFilename`               | Certificate filename                                                                                       | `tls.crt`                    |
| `tls.certKeyFilename`            | Certificate key filename                                                                                   | `tls.key`                    |
| `tls.certCAFilename`             | CA Certificate filename                                                                                    | `ca.crt`                     |
| `tls.cert`                       | Certificate value. Requires `tls.autoGenerated` to be `false`                                              | `""`                         |
| `tls.certKey`                    | Certificate key value. Requires `tls.autoGenerated` to be `false`                                          | `""`                         |
| `tls.certCA`                     | CA Certificate value. Requires `tls.autoGenerated` to be `false`                                           | `""`                         |
| `resources`                      | Set container requests and limits for different resources like CPU or memory                               | `{}`                         |
| `replicaCount`                   | Number of ClickHouse replicas to deploy                                                                    | `1`                          |
| `logLevel`                       | Logging level                                                                                              | `information`                |

### ClickHouse keeper configuration parameters

| Name                                                | Description                                                                              | Value            |
| --------------------------------------------------- | ---------------------------------------------------------------------------------------- | ---------------- |
| `keeper.enabled`                                    | Deploy ClickHouse keeper. Support is experimental.                                       | `false`          |
| `configuration`                                     | Configuration overrides (evaluated as a template)                                        | `""`             |
| `existingConfigmap`                                 | The name of an existing ConfigMap with your custom configuration for ClickHouse          | `""`             |
| `podLabels`                                         | Extra labels for ClickHouse pods                                                         | `{}`             |
| `podAnnotations`                                    | Annotations for ClickHouse pods                                                          | `{}`             |
| `affinity`                                          | Affinity for ClickHouse pods assignment                                                  | `{}`             |
| `nodeSelector`                                      | Node labels for ClickHouse pods assignment                                               | `{}`             |
| `tolerations`                                       | Tolerations for ClickHouse pods assignment                                               | `[]`             |
| `terminationGracePeriodSeconds`                     | Seconds Redmine pod needs to terminate gracefully                                        | `""`             |
| `extraEnvVars`                                      | Array with extra environment variables to add to ClickHouse nodes                        | `[]`             |
| `volumes`                                           | Optionally specify extra list of additional volumes for the ClickHouse pod(s)            | `[]`             |
| `volumeMounts`                                      | Optionally specify extra list of additional volumeMounts for the ClickHouse container(s) | `[]`             |
| `containerPorts.http`                               | ClickHouse HTTP container port                                                           | `8123`           |
| `containerPorts.https`                              | ClickHouse HTTPS container port                                                          | `8443`           |
| `containerPorts.tcp`                                | ClickHouse TCP container port                                                            | `9000`           |
| `containerPorts.tcpSecure`                          | ClickHouse TCP (secure) container port                                                   | `9440`           |
| `containerPorts.keeper`                             | ClickHouse keeper TCP container port                                                     | `2181`           |
| `containerPorts.keeperSecure`                       | ClickHouse keeper TCP (secure) container port                                            | `3181`           |
| `containerPorts.keeperInter`                        | ClickHouse keeper interserver TCP container port                                         | `9444`           |
| `containerPorts.mysql`                              | ClickHouse MySQL container port                                                          | `9004`           |
| `containerPorts.postgresql`                         | ClickHouse PostgreSQL container port                                                     | `9005`           |
| `containerPorts.interserver`                        | ClickHouse Interserver container port                                                    | `9009`           |
| `containerPorts.metrics`                            | ClickHouse metrics container port                                                        | `8001`           |
| `podSecurityContext.enabled`                        | Enabled ClickHouse pods' Security Context                                                | `true`           |
| `podSecurityContext.fsGroupChangePolicy`            | Set filesystem group change policy                                                       | `Always`         |
| `podSecurityContext.sysctls`                        | Set kernel settings using the sysctl interface                                           | `[]`             |
| `podSecurityContext.supplementalGroups`             | Set filesystem extra groups                                                              | `[]`             |
| `podSecurityContext.fsGroup`                        | Set ClickHouse pod's Security Context fsGroup                                            | `1001`           |
| `containerSecurityContext.enabled`                  | Enable containers' Security Context                                                      | `true`           |
| `containerSecurityContext.seLinuxOptions`           | Set SELinux options in container                                                         | `{}`             |
| `containerSecurityContext.runAsUser`                | Set containers' Security Context runAsUser                                               | `1001`           |
| `containerSecurityContext.runAsGroup`               | Set containers' Security Context runAsGroup                                              | `1001`           |
| `containerSecurityContext.runAsNonRoot`             | Set containers' Security Context runAsNonRoot                                            | `true`           |
| `containerSecurityContext.privileged`               | Set read only root file system pod's                                                     | `false`          |
| `containerSecurityContext.allowPrivilegeEscalation` | Set contraller container's Security Context privileged                                   | `false`          |
| `containerSecurityContext.readOnlyRootFilesystem`   | Set contraller container's Security Context allowPrivilegeEscalation                     | `true`           |
| `containerSecurityContext.capabilities.drop`        | List of capabilities to be droppedn                                                      | `["ALL"]`        |
| `containerSecurityContext.seccompProfile.type`      | Set container's Security Context seccomp profile                                         | `RuntimeDefault` |
| `livenessProbe.enabled`                             | Enable livenessProbe on ClickHouse containers                                            | `true`           |
| `livenessProbe.failureThreshold`                    | Failure threshold for livenessProbe                                                      | `3`              |
| `livenessProbe.initialDelaySeconds`                 | Initial delay seconds for livenessProbe                                                  | `10`             |
| `livenessProbe.periodSeconds`                       | Period seconds for livenessProbe                                                         | `10`             |
| `livenessProbe.successThreshold`                    | Success threshold for livenessProbe                                                      | `1`              |
| `livenessProbe.timeoutSeconds`                      | Timeout seconds for livenessProbe                                                        | `1`              |
| `readinessProbe.enabled`                            | Enable readinessProbe on ClickHouse containers                                           | `true`           |
| `readinessProbe.failureThreshold`                   | Failure threshold for readinessProbe                                                     | `3`              |
| `readinessProbe.initialDelaySeconds`                | Initial delay seconds for readinessProbe                                                 | `10`             |
| `readinessProbe.periodSeconds`                      | Period seconds for readinessProbe                                                        | `10`             |
| `readinessProbe.successThreshold`                   | Success threshold for readinessProbe                                                     | `1`              |
| `readinessProbe.timeoutSeconds`                     | Timeout seconds for readinessProbe                                                       | `1`              |
| `startupProbe.enabled`                              | Enable startupProbe on ClickHouse containers                                             | `false`          |
| `startupProbe.failureThreshold`                     | Failure threshold for startupProbe                                                       | `3`              |
| `startupProbe.initialDelaySeconds`                  | Initial delay seconds for startupProbe                                                   | `10`             |
| `startupProbe.periodSeconds`                        | Period seconds for startupProbe                                                          | `10`             |
| `startupProbe.successThreshold`                     | Success threshold for startupProbe                                                       | `1`              |
| `startupProbe.timeoutSeconds`                       | Timeout seconds for startupProbe                                                         | `1`              |

### Service Parameters

| Name                           | Description                                          | Value       |
| ------------------------------ | ---------------------------------------------------- | ----------- |
| `service.type`                 | ClickHouse service type                              | `ClusterIP` |
| `service.ports.http`           | ClickHouse service HTTP port                         | `8123`      |
| `service.ports.https`          | ClickHouse service HTTPS port                        | `443`       |
| `service.ports.tcp`            | ClickHouse service TCP port                          | `9000`      |
| `service.ports.tcpSecure`      | ClickHouse service TCP (secure) port                 | `9440`      |
| `service.ports.keeper`         | ClickHouse keeper TCP container port                 | `2181`      |
| `service.ports.keeperSecure`   | ClickHouse keeper TCP (secure) container port        | `3181`      |
| `service.ports.keeperInter`    | ClickHouse keeper interserver TCP container port     | `9444`      |
| `service.ports.mysql`          | ClickHouse service MySQL port                        | `9004`      |
| `service.ports.postgresql`     | ClickHouse service PostgreSQL port                   | `9005`      |
| `service.ports.interserver`    | ClickHouse service Interserver port                  | `9009`      |
| `service.ports.metrics`        | ClickHouse service metrics port                      | `8001`      |
| `service.annotations`          | Additional custom annotations for ClickHouse service | `{}`        |
| `service.headless.annotations` | Annotations for the headless service.                | `{}`        |

### Persistence Parameters

| Name                                               | Description                                                             | Value               |
| -------------------------------------------------- | ----------------------------------------------------------------------- | ------------------- |
| `persistence.enabled`                              | Enable persistence using Persistent Volume Claims                       | `true`              |
| `persistence.existingClaim`                        | Name of an existing PVC to use                                          | `""`                |
| `persistence.storageClass`                         | Storage class of backing PVC                                            | `""`                |
| `persistence.labels`                               | Persistent Volume Claim labels                                          | `{}`                |
| `persistence.annotations`                          | Persistent Volume Claim annotations                                     | `{}`                |
| `persistence.accessModes`                          | Persistent Volume Access Modes                                          | `["ReadWriteOnce"]` |
| `persistence.size`                                 | Size of data volume                                                     | `8Gi`               |
| `persistence.selector`                             | Selector to match an existing Persistent Volume for ClickHouse data PVC | `{}`                |
| `persistence.dataSource`                           | Custom PVC data source                                                  | `{}`                |
| `persistence.persistentVolumeClaimRetentionPolicy` | PostgreSQL Persistent Volume Claim Retention Policy                     | `{}`                |

### Other Parameters

| Name                         | Description                                                      | Value   |
| ---------------------------- | ---------------------------------------------------------------- | ------- |
| `serviceAccount.create`      | Specifies whether a ServiceAccount should be created             | `true`  |
| `serviceAccount.name`        | The name of the ServiceAccount to use.                           | `""`    |
| `serviceAccount.annotations` | Additional Service Account annotations (evaluated as a template) | `{}`    |
| `serviceAccount.automount`   | Automount service account token for the server service account   | `false` |
| `metrics.enabled`            | Enable the export of Prometheus metrics                          | `false` |
| `metrics.externalHost`       | ClickHouse metrics external host                                 | `""`    |
| `metrics.podAnnotations`     | Annotations for metrics scraping                                 | `{}`    |

### Network Policies

| Name                          | Description                                         | Value  |
| ----------------------------- | --------------------------------------------------- | ------ |
| `networkPolicy.enabled`       | Specifies whether a NetworkPolicy should be created | `true` |
| `networkPolicy.allowExternal` | Don't require server label for connections          | `true` |
| `networkPolicy.extraIngress`  | Add extra ingress rules to the NetworkPolicy        | `[]`   |
| `networkPolicy.extraEgress`   | Add extra ingress rules to the NetworkPolicy        | `[]`   |
