syntax = "proto3";

package runtime_event;

import "tetragon/events.proto";
import "detector.proto";


option go_package = "./api";

message RuntimeEvent {
    // id (as UUID) will be generated by event-processor, so that it can be used in notifier templates
    // when sending notifications, for building URL pointing to a particular event, or as a supplementary info
    string id = 1;
    // TODO: tetragon_version is hardcoded on event_processor side, but it is assumed that it will be passed
    // right from the runtime_monitor
    string tetragon_version = 2;
    tetragon.GetEventsResponse event = 3;
    repeated Threat threats = 4;
    repeated DetectError detect_errors = 5;
    bool is_incident = 6;
    string incident_severity = 7;
    repeated string block_by = 8;
    repeated string notify_by = 9;
}

message Threat {
    detector.Detector detector = 1;
    string severity = 2;
}

message DetectError {
    detector.Detector detector = 1;
    string error = 2;
}
