{
    "image_name": "{{.event.GetImageName}}",
    "block": {{.event.GetBlock}},
    "verdict": "{{.event.GetVerdict}}",
    "rule_name": "{{.event.GetRuleName}}",
    "files": [
        {{$files := .event.GetFiles}}
        {{range $i, $file := $files}}
            {
                "file_path": "{{$file.GetFilePath}}",
                "file_sha256": "{{$file.GetFileSha256}}",
                "malwares": [
                    {{$malwares := $file.GetMalwares}}
                    {{range $j, $malware := $malwares}}
                        {
                            "verdict": "{{$malware.GetVerdict}}",
                            "malware_type": "{{$malware.GetMalwareType}}",
                            "malware_name": "{{$malware.GetMalwareName}}",
                            "engine_name": "{{$malware.GetEngineName}}",
                            "engine_version": "{{$malware.GetEngineVersion}}",
                            "database_version": "{{$malware.GetDatabaseVersion}}"
                        }{{if not (eq $j (sub (len $malwares) 1))}},{{end}}
                    {{end}}
                ]
            }{{if not (eq $i (sub (len $files) 1))}},{{end}}
        {{end}}
    ],
    "registered_at": {
        "seconds": {{.event.GetRegisteredAt.GetSeconds}},
        "nanos": {{.event.GetRegisteredAt.GetNanos}}
    },
    {{if .centralCSURL}}
        "central_cs_url": "{{.centralCSURL}}",
    {{end}}
    {{if .csClusterID}}
        "cs_cluster_id": "{{.csClusterID}}",
    {{end}}
    {{if .csClusterName}}
        "cs_cluster_name": "{{.csClusterName}}",
    {{end}}
    {{if .ownCSURL}}
        "own_cs_url": "{{.ownCSURL}}",
    {{end}}
    {{if and .centralCSURL .event.GetEventId}}
        "event_url": "{{.centralCSURL}}/events/{{.event.GetEventId}}{{if ne .ownCSURL .centralCSURL}}?clusterUrl={{.ownCSURL}}{{end}}",
    {{end}}
    "event_id": "{{.event.GetEventId}}"
}
