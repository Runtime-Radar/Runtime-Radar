<ng-container *transloco="let tIntegration; prefix: 'integration'">
    <ng-container *ngrxLet="{
        emailIntegrations: (emailIntegrations$ | async),
        syslogIntegrations: (syslogIntegrations$ | async),
        webhookIntegrations: (webhookIntegrations$ | async),
        loadStatus: (loadStatus$ | async)
    } as rxlet">
        <header class="layout-row layout-align-space-between-center">
            <h1 class="kbq-display-compact integration-feature-list-title">
                {{ tIntegration('Integration.ListPage.Header.Title') }}
            </h1>
            <section class="layout-row">
                <cs-cluster-select-component
                        [clusters]="clusters$ | async"
                        [activeClusterHost]="activeClusterHost$ | async"
                        (selectClusterId)="switchCluster($event)"
                        testLocator="integration-cluster-select"></cs-cluster-select-component>
                @if ((rxlet.emailIntegrations?.length || rxlet.syslogIntegrations?.length || rxlet.webhookIntegrations?.length) && rxlet.loadStatus === loadStatus.LOADED) {
                    <button kbq-button
                            kbqStyle="outline"
                            color="theme-fade"
                            type="button"
                            class="layout-margin-left-xl"
                            [disabled]="!permissions[permissionName.INTEGRATIONS].has(permissionType.CREATE)"
                            (click)="openCreateSidepanel()"
                            data-testid="integration-open-sidepanel-form-button">
                        {{ tIntegration('Integration.ListPage.Button.Create') }}
                    </button>
                }
            </section>
        </header>

        <section class="layout-column integration-feature-list-section">
            @if (rxlet.emailIntegrations?.length) {
                <cs-integration-feature-collapse-card-container
                        [type]="integrationType.EMAIL"
                        [list]="rxlet.emailIntegrations"
                        [permissions]="permissions"></cs-integration-feature-collapse-card-container>
            }

            @if (rxlet.syslogIntegrations?.length) {
                <cs-integration-feature-collapse-card-container
                        [type]="integrationType.SYSLOG"
                        [list]="rxlet.syslogIntegrations"
                        [permissions]="permissions"></cs-integration-feature-collapse-card-container>
            }

            @if (rxlet.webhookIntegrations?.length) {
                <cs-integration-feature-collapse-card-container
                        [type]="integrationType.WEBHOOK"
                        [list]="rxlet.webhookIntegrations"
                        [permissions]="permissions"></cs-integration-feature-collapse-card-container>
            }

            @if (!rxlet.emailIntegrations?.length && !rxlet.syslogIntegrations?.length && !rxlet.webhookIntegrations?.length && rxlet.loadStatus === loadStatus.LOADED) {
                <cs-empty-screen-component
                        imageUrl="/assets/koobiq/light/folder-plus_256@2x.png"
                        [title]="tIntegration('Integration.ListPage.SubHeading.EmptyResult')"
                        [description]="tIntegration('Integration.ListPage.Text.EmptyResult')">
                    <button kbq-button
                            kbqStyle="outline"
                            color="theme-fade"
                            type="button"
                            [disabled]="!permissions[permissionName.INTEGRATIONS].has(permissionType.CREATE)"
                            (click)="openCreateSidepanel()"
                            data-testid="integration-open-sidepanel-form-empty-button">
                        {{ tIntegration('Integration.ListPage.Button.Create') }}
                    </button>
                </cs-empty-screen-component>
            }
        </section>
    </ng-container>
</ng-container>
