<ng-container *transloco="let tRuntime; prefix: 'runtime'">
    <kbq-sidepanel-header [closeable]="true">
        {{ props.isEdit ? tRuntime('Runtime.PolicyForm.Title.Edit') : tRuntime('Runtime.PolicyForm.Title.Create') }}
    </kbq-sidepanel-header>

    <kbq-sidepanel-body>
        <form [formGroup]="form" class="kbq-form-vertical">
            <section class="kbq-form__row kbq-form-row_margin">
                <label for="name" class="kbq-form__label">
                    {{ tRuntime('Runtime.PolicyForm.Label.Name') }}
                </label>
                <kbq-form-field class="kbq-form__control">
                    <input kbqInput
                           cdkFocusInitial
                           type="text"
                           id="name"
                           formControlName="name"
                           data-testid="runtime-policy-name-input">
                    @if (form.get('name')?.hasError('nameExists')) {
                        <kbq-hint color="error">{{ tRuntime('Runtime.PolicyForm.Error.Name') }}</kbq-hint>
                    }
                </kbq-form-field>
            </section>

            <section class="kbq-form__row kbq-form-row_margin">
                <label for="description" class="kbq-form__label">
                    {{ tRuntime('Runtime.PolicyForm.Label.Description') }}
                </label>
                <kbq-form-field class="kbq-form__control">
                    <textarea kbqTextarea
                              [freeRowsHeight]="0"
                              id="description"
                              formControlName="description"
                              data-testid="runtime-policy-description-textarea"></textarea>
                </kbq-form-field>
            </section>

            <section class="kbq-form__row">
                <label for="description" class="kbq-form__label">
                    {{ tRuntime('Runtime.PolicyForm.Label.Yaml') }}
                </label>
                <kbq-form-field class="kbq-form__control runtime-feature-sidepanel-policy-form-textarea">
                    <textarea kbqTextarea
                              [freeRowsHeight]="0"
                              id="yaml"
                              formControlName="yaml"
                              class="runtime-feature-sidepanel-policy-form-textarea-control"
                              data-testid="runtime-policy-yaml-textarea"></textarea>
                    @if (form.get('yaml')?.hasError('code')) {
                        <kbq-hint color="error">{{ tRuntime('Runtime.PolicyForm.Error.Yaml', { line: form.get('yaml')?.getError('code').line }) }}</kbq-hint>
                    }
                </kbq-form-field>
            </section>
        </form>
    </kbq-sidepanel-body>

    <kbq-sidepanel-footer>
        <kbq-sidepanel-actions align="left">
            <button kbq-button
                    kbqStyle="outline"
                    color="theme-fade"
                    type="button"
                    [disabled]="(isFormValid$ | async) === false"
                    (click)="confirm()"
                    data-testid="runtime-policy-confirm-button">
                {{ props.isEdit ? tRuntime('Runtime.PolicyForm.Button.Update') : tRuntime('Runtime.PolicyForm.Button.Confirm') }}
            </button>
        </kbq-sidepanel-actions>
        <kbq-sidepanel-actions align="right">
            <button kbq-button
                    type="button"
                    (click)="cancel()"
                    data-testid="runtime-policy-cancel-button">
                {{ tRuntime('Runtime.PolicyForm.Button.Cancel') }}
            </button>
        </kbq-sidepanel-actions>
    </kbq-sidepanel-footer>
</ng-container>
