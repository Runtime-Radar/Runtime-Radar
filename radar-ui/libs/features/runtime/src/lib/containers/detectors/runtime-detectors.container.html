<div class="runtime-feature-detectors" *transloco="let tRuntime; prefix: 'runtime'">
    <header class="layout-row layout-align-space-between-center layout-margin-bottom-3xl">
        <h1 class="kbq-display-compact runtime-feature-detectors-title">{{ tRuntime('Runtime.Pseudo.Header.Title') }}</h1>
        <cs-cluster-select-component
                [clusters]="clusters$ | async"
                [activeClusterHost]="activeClusterHost$ | async"
                (selectClusterId)="switchCluster($event)"
                testLocator="runtime-detector-cluster-select"></cs-cluster-select-component>
    </header>
    <cs-tabs-component
            [tabs]="runtimeNavigationTabs"
            [localizationFn]="tRuntime"
            (tabChange)="tabChange($event)"
            testId="runtime-navigation-tab-group">
        <button kbq-button
                kbqStyle="outline"
                color="theme-fade"
                type="button"
                [disabled]="!permissions[permissionName.SYSTEM].has(permissionType.CREATE)"
                (click)="openCreateModal()"
                data-testid="runtime-detector-create-button">
            {{ tRuntime('Runtime.DetectorsPage.Button.Create') }}
        </button>
    </cs-tabs-component>

    <ng-container *ngrxLet="detectors$ as detectors">
        @if (detectors.length) {
            <table kbq-table [border]="true" class="runtime-feature-detectors-table">
                <thead>
                    <tr>
                        <th>{{ tRuntime('Runtime.DetectorsPage.Table.Id') }}</th>
                        <th>{{ tRuntime('Runtime.DetectorsPage.Table.Name') }}</th>
                        <th>{{ tRuntime('Runtime.DetectorsPage.Table.Version') }}</th>
                        <th>{{ tRuntime('Runtime.DetectorsPage.Table.Description') }}</th>
                        <th width="34"></th>
                    </tr>
                </thead>
                <tbody>
                    @for (detector of detectors; track detector.id) {
                        <tr id="{{ detector.id }}" [attr.data-testid]="detector.name">
                            <td>{{ detector.key }}</td>
                            <td>{{ detector.name }}</td>
                            <td>{{ detector.version }}</td>
                            <td>{{ detector.description }}</td>
                            <td>
                                <button kbq-button
                                        kbqStyle="transparent"
                                        color="contrast"
                                        type="button"
                                        class="kbq-button-icon"
                                        [disabled]="!permissions[permissionName.SYSTEM].has(permissionType.DELETE)"
                                        (click)="openDeleteModal(detector.key, detector.version)"
                                        data-testid="runtime-detector-delete-button">
                                    <i kbq-icon="kbq-trash_16"></i>
                                </button>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        } @else {
            <cs-empty-screen-component
                    imageUrl="/assets/koobiq/light/empty_256@2x.png"
                    [title]="tRuntime('Runtime.DetectorsPage.SubHeading.EmptyResult')"
                    [description]="tRuntime('Runtime.DetectorsPage.Text.EmptyResult')">
            </cs-empty-screen-component>
        }
    </ng-container>
</div>
